<!DOCTYPE html>
<html>

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>ÈîÆÁõò‰∫ã‰ª∂code/key/keyCodeÂØπÁÖß‰∏ÄËßàË°®</title>

    <!-- <link rel="stylesheet" href="css/style.css" media="screen" type="text/css" /> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-table@1.21.1/dist/bootstrap-table.min.css">
    <!-- <link rel="stylesheet" href="./theme.css"> -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/css/index.css">
    <link rel="stylesheet" href="./css/index.css">

</head>

<body>
    <style type="text/css">

    </style>

    <div class="container">
        <div class="row">
            <div class="col-6">
                <div class="table-container">
                    <ul class="nav nav-tabs" id="myTab" role="tablist">
                        <li class="nav-item" role="presentation">
                            <a class="nav-link active" id="home-tab" data-bs-toggle="tab" data-bs-target="#home" type="button" role="tab" aria-controls="home" aria-selected="true">ÈîÆÁõòÂΩïÂÖ•</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="profile-tab" data-bs-toggle="tab" data-bs-target="#profile" type="button" role="tab" aria-controls="profile" aria-selected="false">keyCodeÂèçÊü•</a>
                        </li>
                        <li class="nav-item" role="presentation">
                            <a class="nav-link" id="contact-tab" data-bs-toggle="tab" data-bs-target="#contact" type="button" role="tab" aria-controls="contact" aria-selected="false">ÂàÜÁ±ªË°®</a>
                        </li>
                    </ul>
                    <div class="tab-content" id="myTabContent">
                        <!-- ÈîÆÁõòÂΩïÂÖ• -->
                        <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                            <div id='wrapper'>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">@</span>
                                    </div>
                                    <input type="text" class="form-control" placeholder="ÂΩïÂÖ•" aria-label="ÂΩïÂÖ•" aria-describedby="basic-addon1" id="input">
                                </div>
                                <div>
                                    <table class="table table-condensed" id="typedTable" data-toggle="table" data-height="600">
                                    </table>
                                </div>
                            </div>
                        </div>
                        <!-- keyCodeÊü•ËØ¢ -->
                        <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">
                            <div id='wrapper'>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">#</span>
                                    </div>
                                    <input type="text" class="form-control" placeholder="ËØ∑ËæìÂÖ•keyCodeÊï∞ÂÄº" aria-label="ËØ∑ËæìÂÖ•keyCodeÊï∞ÂÄº" aria-describedby="basic-addon1" id="inputNumber">
                                </div>
                                <div>
                                    <table class="table table-condensed" id="searchTable" data-toggle="table" data-height="600">
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div class="tab-pane fade" id="contact" role="tabpanel" aria-labelledby="contact-tab">
                            <div id='wrapper'>
                                <div class="input-group mb-3">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text" id="basic-addon1">%</span>
                                    </div>
                                    <input type="text" class="form-control" placeholder="ËØ∑ËæìÂÖ•keyCodeÊï∞ÂÄº" aria-label="ËØ∑ËæìÂÖ•keyCodeÊï∞ÂÄº" aria-describedby="basic-addon1" id="inputValue">
                                </div>
                                <div>
                                    <table class="table table-condensed" id="categoryTable" data-toggle="table" data-height="600">
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-6">

                <div class="keyboard-container">
                    <input class="input" placeholder="Tap on the virtual keyboard to start" />
                    <div class="simple-keyboard"></div>
                </div>
            </div>
        </div>

    </div>
    <!-- Content here -->

    </div>

    <script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap-table@1.21.1/dist/bootstrap-table.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/simple-keyboard@latest/build/index.js"></script>
    <script src="./data.js"></script>
    <script>
        var data = keyData;
        var code;
        var key;
        var keyCode;
        var input = document.getElementById("input");
        var inputNumber = $('#inputNumber');
        var typedTable = $('#typedTable');
        var searchTable = $('#searchTable');
        var categoryTable = $('#categoryTable');
        var navLink = $('.nav-link');
        var tableConfig = {
            sidePagination: "true",
            striped: true, // ÊòØÂê¶ÊòæÁ§∫Ë°åÈó¥ÈöîËâ≤
            //search : "true",
            uniqueId: "ID",
            pageSize: "5",
            pagination: false, // ÊòØÂê¶ÂàÜÈ°µ
            sortable: true, // ÊòØÂê¶ÂêØÁî®ÊéíÂ∫è
            columns: [{
                    field: 'key',
                    title: 'key',
                    width: 80,
                    align: 'center',
                    valign: 'middle',
                }, {
                    field: 'code',
                    title: 'code',
                    width: 80,
                    align: 'center',
                    valign: 'middle',
                }, {
                    field: 'keyCode',
                    title: 'keyCode',
                    width: 40,
                    align: 'center',
                    valign: 'middle',
                },

            ]
        }

        typedTable.bootstrapTable(tableConfig);
        searchTable.bootstrapTable(tableConfig);
        categoryTable.bootstrapTable(tableConfig);

        document.addEventListener('keydown', function(e) {
            // Â±ïÁ§∫ÈîÆÁõò‰∫ã‰ª∂ÂØπË±°‰∏≠ÁöÑÂ±ûÊÄß
            console.log('üöÄ -> document.addEventListener -> e', e);
            let rowData = {
                key: e.key,
                code: e.code,
                keyCode: e.keyCode,
            }
            typedTable.bootstrapTable('insertRow', {
                index: 0,
                row: rowData
            })
        })
        navLink.on('click', function(e) {
            console.log('üöÄ -> navLink.on -> e', e);
            searchTable.bootstrapTable('resetView');

        });

        searchTable.bootstrapTable('load', data);
        categoryTable.bootstrapTable('load', data);
        inputNumber.bind('input porpertychange', function(e) {
            console.log('üöÄ -> inputNumber.bind -> e', e);
            let value = e.target.value;
            console.log('üöÄ -> inputNumber.bind -> value', value);
            console.log('üöÄ -> inputNumber.bind -> value typeof ', typeof value);
            if (value === null || value === undefined || value === '') {
                searchTable.bootstrapTable('load', data);
            } else {
                let rowDatas = data.filter((item) => {
                    return String(item.keyCode) === value;
                });
                console.log('üöÄ -> rowDatas -> rowDatas', rowDatas);
                searchTable.bootstrapTable('load', rowDatas)
            }

        });
        const Keyboard = window.SimpleKeyboard.default;
        console.log('üöÄ -> window.SimpleKeyboard', window.SimpleKeyboard);

        const keyboard = new Keyboard({
            onChange: input => onChange(input),
            onKeyPress: button => onKeyPress(button)
        });

        // keyboard.setOptions({
        //     layout: 'fullKeyboard'
        // })

        function onChange(input) {
            document.querySelector(".input").value = input;
            console.log("Input changed", input);
        }

        function onKeyPress(button) {
            console.log("Button pressed", button);
        }
        /**
         * Update simple-keyboard when input is changed directly
         */
        document.querySelector(".input").addEventListener("input", event => {
            console.log('üöÄ -> document.querySelector -> event', event);
            keyboard.setInput(event.target.value);
        });
        console.log('üöÄ -> document.querySelector -> keyboard', keyboard);


        /**
         * Handle keyboard press
         */
        document.addEventListener("keydown", event => {
            highlightButton(event);
        });

        document.addEventListener("keyup", event => {
            unhighlightButton(event);
        });

        function highlightButton(event) {
            let layoutKeyName = keyboard.physicalKeyboard.getSimpleKeyboardLayoutKey(
                event
            );

            /**
             * CUSTOM: Making key lowercase
             */
            layoutKeyName = layoutKeyName.toLowerCase();
            console.log('üöÄ -> highlightButton -> layoutKeyName', layoutKeyName);

            let buttonElement =
                keyboard.getButtonElement(layoutKeyName) ||
                keyboard.getButtonElement(`{${layoutKeyName}}`);

            if (!buttonElement) {
                console.log("Could not find button in layout", layoutKeyName);
                return false;
            }

            buttonElement.style.background = "#9ab4d0";
            buttonElement.style.color = "white";
        }

        function unhighlightButton(event) {
            let layoutKeyName = keyboard.physicalKeyboard.getSimpleKeyboardLayoutKey(
                event
            );

            /**
             * CUSTOM: Making key lowercase
             */
            layoutKeyName = layoutKeyName.toLowerCase();

            let buttonElement =
                keyboard.getButtonElement(layoutKeyName) ||
                keyboard.getButtonElement(`{${layoutKeyName}}`);

            if (!buttonElement) {
                console.log("Could not find button in layout", layoutKeyName);
                return false;
            }

            buttonElement.removeAttribute("style");
        }
    </script>
</body>

</html>